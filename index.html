<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>biofiles by gschofl</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>biofiles</h1>
        <p>R interface to GenBank/GenPept files</p>

        <p class="view"><a href="https://github.com/gschofl/biofiles">View the Project on GitHub <small>gschofl/biofiles</small></a></p>


        <ul>
          <li><a href="https://github.com/gschofl/biofiles/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/gschofl/biofiles/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/gschofl/biofiles">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a id="biofiles---an-interface-to-genbankgenpept-files-in-r" class="anchor" href="#biofiles---an-interface-to-genbankgenpept-files-in-r" aria-hidden="true"><span class="octicon octicon-link"></span></a>biofiles - an interface to GenBank/GenPept files in R</h1>

<p><a href="https://travis-ci.org/gschofl/biofiles"><img src="https://travis-ci.org/gschofl/biofiles.png?branch=master" alt="Build Status"></a></p>

<p>This is an R package for interfacing with GenBank and GenPept flat
file records. It includes utilities for reading and writing GenBank
files, and methods for interacting with annotation and sequence data.</p>

<h3>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h3>

<p>This package is ony available via github. It currently depends on the Boost
regex library and will be made available on CRAN as soon as C++11 support is in
place on CRAN and I can get rid of this external dependency.</p>

<div class="highlight highlight-r"><pre>install.packages(<span class="pl-s1"><span class="pl-pds">"</span>devtools<span class="pl-pds">"</span></span>)  <span class="pl-c"># if not already installed</span>
library(<span class="pl-s1"><span class="pl-pds">"</span>devtools<span class="pl-pds">"</span></span>)
install_github(<span class="pl-s1"><span class="pl-pds">"</span>gschofl/biofiles<span class="pl-pds">"</span></span>)</pre></div>

<h3>
<a id="basic-functionality" class="anchor" href="#basic-functionality" aria-hidden="true"><span class="octicon octicon-link"></span></a>Basic functionality</h3>

<p>Let's download a small bacterial genome, <em>Chlamydophila psittaci</em> DC15
(GenBank acc. CP002806; GI 334693792) from NCBI.</p>

<div class="highlight highlight-r"><pre>require(<span class="pl-vo">reutils</span>)
<span class="pl-vo">gb_file</span> <span class="pl-k">&lt;-</span> efetch(<span class="pl-s1"><span class="pl-pds">"</span>CP002806<span class="pl-pds">"</span></span>, <span class="pl-s1"><span class="pl-pds">"</span>nuccore<span class="pl-pds">"</span></span>, <span class="pl-v">rettype</span> <span class="pl-k">=</span> <span class="pl-s1"><span class="pl-pds">"</span>gbwithparts<span class="pl-pds">"</span></span>, <span class="pl-v">retmode</span> <span class="pl-k">=</span> <span class="pl-s1"><span class="pl-pds">"</span>text<span class="pl-pds">"</span></span>)</pre></div>

<p>Next, we parse the <code>efetch</code> object into a <code>gbRecord</code> instance.</p>

<div class="highlight highlight-r"><pre><span class="pl-vo">rec</span> <span class="pl-k">&lt;-</span> gbRecord(<span class="pl-vo">gb_file</span>)
<span class="pl-vo">rec</span>

 <span class="pl-c">##  An object of class 'gbRecord', with 2040 features</span>
 <span class="pl-c">##  LOCUS       CP002806             1172182 bp    DNA     circular BCT 31 ...</span>
 <span class="pl-c">##  DEFINITION  Chlamydophila psittaci 02DC15, complete genome.</span>
 <span class="pl-c">##  ACCESSION   CP002806</span>
 <span class="pl-c">##  VERSION     CP002806.1  GI:334693792</span>
 <span class="pl-c">##  DBLINK      Project: PRJNA66481</span>
 <span class="pl-c">##  KEYWORDS    .</span>
 <span class="pl-c">##  SOURCE      Chlamydia psittaci 02DC15</span>
 <span class="pl-c">##    ORGANISM  Chlamydia psittaci 02DC15</span>
 <span class="pl-c">##              Bacteria; Chlamydiae; Chlamydiales; Chlamydiaceae;</span>
 <span class="pl-c">##              Chlamydia/Chlamydophila group; Chlamydia.</span>
 <span class="pl-c">##  REFERENCE   1  (bases 1 to 1172182)</span>
 <span class="pl-c">##    AUTHORS   Schofl,G., Voigt,A., Litsche,K., Sachse,K. and Saluz,H.P.</span>
 <span class="pl-c">##    TITLE     Complete Genome Sequences of Four Mammalian Isolates of</span>
 <span class="pl-c">##              Chlamydophila psittaci</span>
 <span class="pl-c">##    JOURNAL   J. Bacteriol. 193 (16), 4258 (2011)</span>
 <span class="pl-c">##    PUBMED    21705611</span>
 <span class="pl-c">##  REFERENCE   2  (bases 1 to 1172182)</span>
 <span class="pl-c">##    AUTHORS   Schofl,G.</span>
 <span class="pl-c">##    TITLE     Direct Submission</span>
 <span class="pl-c">##    JOURNAL   Submitted (20-MAY-2011) Cell and Molecular Biology,</span>
 <span class="pl-c">##              Leibniz Institute for Natural Product Research and</span>
 <span class="pl-c">##              Infection Biology, Beutenbergstrasse 11a, Jena D-07745,</span>
 <span class="pl-c">##              Germany</span>
 <span class="pl-c">##  COMMENT     Source DNA available from Dr. Konrad Sachse</span>
 <span class="pl-c">##              (Konrad.Sachse@fli.bund.de) at the Institute for Molecular</span>
 <span class="pl-c">##              Pathogenesis, Jena, Germany.</span>
 <span class="pl-c">##  ORIGIN      CAAAGTTTTAAACATGTTAACCACGTTGTTTTCCCTCTATAAACCGAGTTTTAAACAGT</span>
 <span class="pl-c">##              ...</span>
 <span class="pl-c">##              ATCTTGTGTTCACAAACATGCAAAATCTCGATTTATTTACAAACTGAACAATGTTTTAA</span>
 <span class="pl-c">##  CONTIG</span></pre></div>

<p>The <code>summary</code> function provides an overview over the object:</p>

<div class="highlight highlight-r"><pre>summary(<span class="pl-vo">rec</span>)

 <span class="pl-c">##  [[CP002806]]</span>
 <span class="pl-c">##    1172182 bp: Chlamydophila psittaci 02DC15, complete genome.</span>
 <span class="pl-c">##     Id Feature Location                     GeneId Product           ...</span>
 <span class="pl-c">##      1 source  1..1172182                   NA     NA                ...</span>
 <span class="pl-c">##      2 gene    149..1144                    hemB   NA                ...</span>
 <span class="pl-c">##      3 CDS     149..1144                    hemB   delta-aminolevuli ...</span>
 <span class="pl-c">##      4 gene    complement(1160..2578)       NA     NA                ...</span>
 <span class="pl-c">##      5 CDS     complement(1160..2578)       NA     Na(+)-translocati ...</span>
 <span class="pl-c">##      6 gene    complement(2601..3035)       NA     NA                ...</span>
 <span class="pl-c">##      7 CDS     complement(2601..3035)       NA     conserved hypothe ...</span>
 <span class="pl-c">##    ... ...     ...                          ...    ...               ...</span>
 <span class="pl-c">##   2034 CDS     1169125..1170006             NA     geranylgeranyl py ...</span>
 <span class="pl-c">##   2035 gene    complement(1170021..1170094) NA     NA                ...</span>
 <span class="pl-c">##   2036 tRNA    complement(1170021..1170094) NA     tRNA-Pro          ...</span>
 <span class="pl-c">##   2037 gene    complement(1170106..1170360) NA     NA                ...</span>
 <span class="pl-c">##   2038 CDS     complement(1170106..1170360) NA     conserved hypothe ...</span>
 <span class="pl-c">##   2039 gene    complement(1170443..1172035) NA     NA                ...</span>
 <span class="pl-c">##   2040 CDS     complement(1170443..1172035) NA     conserved hypothe ...</span></pre></div>

<p>Various getter methods provide access to the data contained in a GenBank record;
for instance:</p>

<div class="highlight highlight-r"><pre>getAccession(<span class="pl-vo">rec</span>)

 <span class="pl-c">##  [1] "CP002806"</span></pre></div>

<div class="highlight highlight-r"><pre>getGeneID(<span class="pl-vo">rec</span>)

 <span class="pl-c">##  [1] "334693792"</span></pre></div>

<div class="highlight highlight-r"><pre>getDefinition(<span class="pl-vo">rec</span>)

 <span class="pl-c">##  [1] "Chlamydophila psittaci 02DC15, complete genome."</span></pre></div>

<div class="highlight highlight-r"><pre>getOrganism(<span class="pl-vo">rec</span>)

 <span class="pl-c">##  [1] "Chlamydia psittaci 02DC15"</span></pre></div>

<div class="highlight highlight-r"><pre>getSequence(<span class="pl-vo">rec</span>)

 <span class="pl-c">##    A DNAStringSet instance of length 1</span>
 <span class="pl-c">##        width seq                                        names               </span>
 <span class="pl-c">##  [1] 1172182 CAAAGTTTTAAACATGTTAA...AAACTGAACAATGTTTTAA CP002806</span></pre></div>

<div class="highlight highlight-r"><pre>getReference(<span class="pl-vo">rec</span>)

 <span class="pl-c">##  A 'gbReferenceList' instance:</span>
 <span class="pl-c">##  REFERENCE   1  (bases 1 to 1172182)</span>
 <span class="pl-c">##    AUTHORS   Schofl,G., Voigt,A., Litsche,K., Sachse,K. and Saluz,H.P.</span>
 <span class="pl-c">##    TITLE     Complete Genome Sequences of Four Mammalian Isolates of</span>
 <span class="pl-c">##              Chlamydophila psittaci</span>
 <span class="pl-c">##    JOURNAL   J. Bacteriol. 193 (16), 4258 (2011)</span>
 <span class="pl-c">##    PUBMED    21705611</span>
 <span class="pl-c">##  REFERENCE   2  (bases 1 to 1172182)</span>
 <span class="pl-c">##    AUTHORS   Schofl,G.</span>
 <span class="pl-c">##    TITLE     Direct Submission</span>
 <span class="pl-c">##    JOURNAL   Submitted (20-MAY-2011) Cell and Molecular Biology,</span>
 <span class="pl-c">##              Leibniz Institute for Natural Product Research and</span>
 <span class="pl-c">##              Infection Biology, Beutenbergstrasse 11a, Jena D-07745,</span>
 <span class="pl-c">##              Germany</span>
 <span class="pl-c">##  </span></pre></div>

<p><code>uniqueQualifs()</code> provides an overview over the feature qualifiers used
in a record:</p>

<div class="highlight highlight-r"><pre>uniqueQualifs(<span class="pl-vo">rec</span>)

 <span class="pl-c">##   [1] "organism"            "mol_type"            "strain"             </span>
 <span class="pl-c">##   [4] "db_xref"             "gene"                "locus_tag"          </span>
 <span class="pl-c">##   [7] "note"                "codon_start"         "transl_table"       </span>
 <span class="pl-c">##  [10] "product"             "protein_id"          "translation"        </span>
 <span class="pl-c">##  [13] "EC_number"           "artificial_location"</span></pre></div>

<h3>
<a id="genbank-features" class="anchor" href="#genbank-features" aria-hidden="true"><span class="octicon octicon-link"></span></a>Genbank Features</h3>

<p>The important part of GenBank record will generally be the list of annotions
or features.</p>

<p>We can access the <code>gbFeatureList</code> of a <code>gbRecord</code> using <code>getFeatures()</code> or <code>ft()</code>:</p>

<div class="highlight highlight-r"><pre><span class="pl-vo">f</span> <span class="pl-k">&lt;-</span> ft(<span class="pl-vo">rec</span>)
<span class="pl-vo">f</span>

 <span class="pl-c">##  'gbFeatureTable' with 2040 features:</span>
 <span class="pl-c">##  Feature:        Location/Qualifiers:</span>
 <span class="pl-c">##  source          1..1172182</span>
 <span class="pl-c">##                  /organism = "Chlamydia psittaci 02DC15"</span>
 <span class="pl-c">##                  /mol_type = "genomic DNA"</span>
 <span class="pl-c">##                  /strain = "02DC15"</span>
 <span class="pl-c">##                  /db_xref = "taxon:1112254"</span>
 <span class="pl-c">##  ...</span>
 <span class="pl-c">##  Feature:        Location/Qualifiers:</span>
 <span class="pl-c">##  CDS             complement(1170443..1172035)</span>
 <span class="pl-c">##                  /locus_tag = "CPS0B_1080"</span>
 <span class="pl-c">##                  /note = "[F] COG1351 Predicted alternative thymidylate</span>
 <span class="pl-c">##                  synthase"</span>
 <span class="pl-c">##                  /codon_start = "1"</span>
 <span class="pl-c">##                  /transl_table = "11"</span>
 <span class="pl-c">##                  /product = "conserved hypothetical protein"</span>
 <span class="pl-c">##                  /protein_id = "AEG87987.1"</span>
 <span class="pl-c">##                  /db_xref = "GI:334694770"</span>
 <span class="pl-c">##                  /translation = "MLSRDDEFSSEQRKSLSHFVTNLETNIFALKNLPEVVKGA</span>
 <span class="pl-c">##                  LFSKYSRSTLGLRSLLLKEFLEGEGGDFLDSSGVDFEVGIHKAADFYRRVLDGFG</span>
 <span class="pl-c">##                  DDSIGELGGAHLAIESVSMLAAKILEDARIGGSPLEKSSRYVYFDQKVKGEYLYY</span>
 <span class="pl-c">##                  RDPILMTSAFKDVFLGTCDFLFDTYADLIPKVRTYFEKIYPKESEVSQSAYTISL</span>
 <span class="pl-c">##                  RAKVLDCLRGLLPAATLTNLGFFGNGRFWQTLLHKIQGHNLTEIRQIGESSLTEL</span>
 <span class="pl-c">##                  MKIIPSFVSRAESHHHHHQAMLSYRQTLREQLTSLAEKFSGGSHPSKQTGVRLVY</span>
 <span class="pl-c">##                  GDPEGIYKVAAGFLFPYSEHTYEELINICKSMPREDLIRVLEAGSSSRENRRHKS</span>
 <span class="pl-c">##                  PRGLECLEFGFDITADFGAYRDLQRHRILTQERQLLTTNLGYHIPEQLLDTPMEK</span>
 <span class="pl-c">##                  DFREAMEKAEEAYNQISLEFPEEAQYVVPLAYNIRWFFHINGRALQWLCELRSQV</span>
 <span class="pl-c">##                  QGHENYRKIAIDMVKEVIRFDPVYESFFKFVDYSECDLGRIKQESRKRSF"</span>
 <span class="pl-c">##  Seqinfo:</span>
 <span class="pl-c">##  CP002806  1172182 DNA  Chlamydophila psittaci 02DC15, complete genome.</span></pre></div>

<p>We can extract features either by numeric subsetting:</p>

<div class="highlight highlight-r"><pre><span class="pl-vo">f</span>[[<span class="pl-c1">1</span>]]

 <span class="pl-c">##  Feature:        Location/Qualifiers:</span>
 <span class="pl-c">##  source          1..1172182</span>
 <span class="pl-c">##                  /organism = "Chlamydia psittaci 02DC15"</span>
 <span class="pl-c">##                  /mol_type = "genomic DNA"</span>
 <span class="pl-c">##                  /strain = "02DC15"</span>
 <span class="pl-c">##                  /db_xref = "taxon:1112254"</span>
 <span class="pl-c">##  Seqinfo:</span>
 <span class="pl-c">##  CP002806  1172182 DNA  Chlamydophila psittaci 02DC15, complete genome.</span></pre></div>

<p>or we can subset by feature key:</p>

<div class="highlight highlight-r"><pre><span class="pl-vo">f</span>[<span class="pl-s1"><span class="pl-pds">"</span>CDS<span class="pl-pds">"</span></span>][[<span class="pl-c1">2</span>]]

 <span class="pl-c">##  Feature:        Location/Qualifiers:</span>
 <span class="pl-c">##  CDS             complement(1160..2578)</span>
 <span class="pl-c">##                  /locus_tag = "CPS0B_0002"</span>
 <span class="pl-c">##                  /EC_number = "1.6.5.-"</span>
 <span class="pl-c">##                  /note = "[C] COG1726 Na+-transporting NADH:ubiquinone</span>
 <span class="pl-c">##                  oxidoreductase, subunit NqrA"</span>
 <span class="pl-c">##                  /codon_start = "1"</span>
 <span class="pl-c">##                  /transl_table = "11"</span>
 <span class="pl-c">##                  /product = "Na(+)-translocating NADH:ubiquinone</span>
 <span class="pl-c">##                  oxidoreductase subunit A"</span>
 <span class="pl-c">##                  /protein_id = "AEG87011.1"</span>
 <span class="pl-c">##                  /db_xref = "GI:334693794"</span>
 <span class="pl-c">##                  /translation = "MKIAITRGLDLSLQGSPKESGFLKRIDPALVSVDLRPYSA</span>
 <span class="pl-c">##                  LTLKLKVEQGQAISSGSPVAEYKNFPGVFITSPVSGTVQEIRRGDKRSLLDVVIK</span>
 <span class="pl-c">##                  KNPGQNLTEYSYDLSKLSRQELLEIFKKEGLFALFKQRPFDIPALPTHHPRDVFI</span>
 <span class="pl-c">##                  NLADNRPFTPSTEKHLSVFSSREEGFYVFNVGVRAIAKLFGLCPHIISTDRLAIP</span>
 <span class="pl-c">##                  EKDLKSIAHLHKITGPYPSGSPSTHIHYIAPITSEKDVVFTISFQEVLAIGHLFL</span>
 <span class="pl-c">##                  KGRILNEQVVALAGSGLKPSLRRYVITTRGADFQSLLPLDEIASDQVSLISGDPL</span>
 <span class="pl-c">##                  TGRLCDKEHLPCLGMRDATISVIPNPQKRQAFNFLRLGINKPTLTRTYLSGFLKR</span>
 <span class="pl-c">##                  KHTYMDPDTNLHGETRPIIDTEIYDKVMAMKIPVVPLIKSVITKNFELACMLGFL</span>
 <span class="pl-c">##                  EVCPEDFALPTFIDPSKTEMLTIIKEALKHYAKETGILNPENTADTE"</span>
 <span class="pl-c">##  Seqinfo:</span>
 <span class="pl-c">##  CP002806  1172182 DNA  Chlamydophila psittaci 02DC15, complete genome.</span></pre></div>

<p>A more versatile method to narrow down the list of features of interest is the 
function <code>filter()</code>.
For instance, we can filter for all coding sequences (CDS) with the
annotation "hypothetical" in the product qualifiers:</p>

<div class="highlight highlight-r"><pre><span class="pl-vo">hypo</span> <span class="pl-k">&lt;-</span> filter(<span class="pl-vo">rec</span>, <span class="pl-v">key</span> <span class="pl-k">=</span> <span class="pl-s1"><span class="pl-pds">"</span>CDS<span class="pl-pds">"</span></span>, <span class="pl-v">product</span> <span class="pl-k">=</span> <span class="pl-s1"><span class="pl-pds">"</span>hypothetical<span class="pl-pds">"</span></span>)
summary(<span class="pl-vo">hypo</span>)

 <span class="pl-c">##  [[CP002806]]</span>
 <span class="pl-c">##    1172182 bp: Chlamydophila psittaci 02DC15, complete genome.</span>
 <span class="pl-c">##     Id Feature Location                     GeneId Product           ...</span>
 <span class="pl-c">##      7 CDS     complement(2601..3035)       NA     conserved hypothe ...</span>
 <span class="pl-c">##     31 CDS     20427..21713                 NA     conserved hypothe ...</span>
 <span class="pl-c">##     33 CDS     21822..23741                 NA     conserved hypothe ...</span>
 <span class="pl-c">##     35 CDS     complement(23931..26531)     NA     conserved hypothe ...</span>
 <span class="pl-c">##     37 CDS     26689..29340                 NA     conserved hypothe ...</span>
 <span class="pl-c">##     39 CDS     29390..29620                 NA     conserved hypothe ...</span>
 <span class="pl-c">##     43 CDS     complement(30347..30832)     NA     conserved hypothe ...</span>
 <span class="pl-c">##    ... ...     ...                          ...    ...               ...</span>
 <span class="pl-c">##   2002 CDS     1152648..1153925             NA     conserved hypothe ...</span>
 <span class="pl-c">##   2008 CDS     complement(1155986..1156711) NA     conserved hypothe ...</span>
 <span class="pl-c">##   2010 CDS     complement(1156746..1157474) NA     conserved hypothe ...</span>
 <span class="pl-c">##   2024 CDS     1163308..1164144             NA     conserved hypothe ...</span>
 <span class="pl-c">##   2028 CDS     complement(1165683..1167527) NA     conserved hypothe ...</span>
 <span class="pl-c">##   2038 CDS     complement(1170106..1170360) NA     conserved hypothe ...</span>
 <span class="pl-c">##   2040 CDS     complement(1170443..1172035) NA     conserved hypothe ...</span>
<span class="pl-vo">r</span>
length(<span class="pl-vo">hypo</span>)

 <span class="pl-c">##  [1] 249</span></pre></div>

<p>or we can filter for all elongation factors,</p>

<div class="highlight highlight-r"><pre><span class="pl-vo">elong</span> <span class="pl-k">&lt;-</span> filter(<span class="pl-vo">rec</span>, <span class="pl-v">key</span> <span class="pl-k">=</span> <span class="pl-s1"><span class="pl-pds">"</span>CDS<span class="pl-pds">"</span></span>, <span class="pl-v">product</span> <span class="pl-k">=</span> <span class="pl-s1"><span class="pl-pds">"</span>elongation factor<span class="pl-pds">"</span></span>)
summary(<span class="pl-vo">elong</span>)

 <span class="pl-c">##  [[CP002806]]</span>
 <span class="pl-c">##    1172182 bp: Chlamydophila psittaci 02DC15, complete genome.</span>
 <span class="pl-c">##     Id Feature Location                   GeneId Product             ...</span>
 <span class="pl-c">##      9 CDS     3148..5301                 greA   transcription elong ...</span>
 <span class="pl-c">##    103 CDS     complement(56119..56967)   tsf    translation elongat ...</span>
 <span class="pl-c">##    408 CDS     206213..208297             fusA   translation elongat ...</span>
 <span class="pl-c">##    950 CDS     complement(526454..527758) nusA   transcription elong ...</span>
 <span class="pl-c">##   1126 CDS     623470..624027             NA     elongation factor P ...</span>
 <span class="pl-c">##   1406 CDS     complement(805145..806329) tuf    translation elongat ...</span>
 <span class="pl-c">##   1750 CDS     complement(997270..997842) efp    translation elongat ...</span></pre></div>

<p>now let's extract the sequence for all elongation factors, and using the tools
from the <code>Biostrings</code> packages, translate them into protein sequences. Note, that
in order to do so, we first get the <code>gbFeatureTable</code> from the <code>gbRecord</code>, as otherwise
we'd just extract the complete sequence associated with the GenBank record.</p>

<div class="highlight highlight-r"><pre>require(<span class="pl-vo">Biostrings</span>)
<span class="pl-vo">dna</span> <span class="pl-k">&lt;-</span> getSequence(ft(<span class="pl-vo">elong</span>))
<span class="pl-vo">dna</span>

 <span class="pl-c">##    A DNAStringSet instance of length 7</span>
 <span class="pl-c">##      width seq                                          names               </span>
 <span class="pl-c">##  [1]  2154 GTGGACTATCTAGAAAAGTTG...AATCTATTTGGGATGCATAA lcl|CDS.9|gb|CP00...</span>
 <span class="pl-c">##  [2]   849 TTAAGCTCCTATTTTCCATAA...TCCATAGAAAAGTTGCTCAT lcl|CDS.103|gb|CP...</span>
 <span class="pl-c">##  [3]  2085 ATGAGTGATCAAGAATTCGAT...AAGAGATTGTTAAGAAGTAA lcl|CDS.408|gb|CP...</span>
 <span class="pl-c">##  [4]  1305 TTAATCTTCAATTTTAGGTTT...GCTACAAGATCTTTATTCAT lcl|CDS.950|gb|CP...</span>
 <span class="pl-c">##  [5]   558 ATGGTATTAAGTAGCCAGCTC...AATATATTCAACGCGTCTAA lcl|CDS.1126|gb|C...</span>
 <span class="pl-c">##  [6]  1185 TTAGGCAATAATTTTTGAAAT...TGAAAAGTTTCTTTTGACAT lcl|CDS.1406|gb|C...</span>
 <span class="pl-c">##  [7]   573 TTACTTGGAAACACGCGATTC...CTAGTGCTTACACGAACCAT lcl|CDS.1750|gb|C...</span></pre></div>

<div class="highlight highlight-r"><pre><span class="pl-vo">str</span> <span class="pl-k">&lt;-</span> strand(<span class="pl-vo">elong</span>)
<span class="pl-vo">dna_revcomp</span> <span class="pl-k">&lt;-</span> c(reverseComplement(<span class="pl-vo">dna</span>[<span class="pl-vo">str</span> <span class="pl-k">==</span> <span class="pl-k">-</span><span class="pl-c1">1</span>]), <span class="pl-vo">dna</span>[<span class="pl-vo">str</span> <span class="pl-k">==</span> <span class="pl-c1">1</span>])
<span class="pl-vo">aa</span> <span class="pl-k">&lt;-</span> translate(<span class="pl-vo">dna_revcomp</span>)
names(<span class="pl-vo">aa</span>) <span class="pl-k">&lt;-</span> names(<span class="pl-vo">dna_revcomp</span>)
<span class="pl-vo">aa</span>

 <span class="pl-c">##    A AAStringSet instance of length 7</span>
 <span class="pl-c">##      width seq                                          names               </span>
 <span class="pl-c">##  [1]   283 MSNFSMETLKLLRQQTGVGLT...KTSGNSVEVKEFILWKIGA* lcl|CDS.103|gb|CP...</span>
 <span class="pl-c">##  [2]   435 MNKDLVAIFDYMEKEKGIQRP...EQVSKYGEGKVDEKPKIED* lcl|CDS.950|gb|CP...</span>
 <span class="pl-c">##  [3]   395 MSKETFQRTKPHINIGTIGHV...AIREGGRTIGAGTISKIIA* lcl|CDS.1406|gb|C...</span>
 <span class="pl-c">##  [4]   191 MVRVSTSEFRVGLRIEIDGQP...GEVVKVDTRTGSYESRVSK* lcl|CDS.1750|gb|C...</span>
 <span class="pl-c">##  [5]   718 VDYLEKLQVLIDEEQPSSFFN...LQFQGKKYKISRIQSIWDA* lcl|CDS.9|gb|CP00...</span>
 <span class="pl-c">##  [6]   695 MSDQEFDLSKIRNIGIMAHID...EPAFFAKVPQKIQEEIVKK* lcl|CDS.408|gb|CP...</span>
 <span class="pl-c">##  [7]   186 MVLSSQLSVGMFISTKDGLYK...EIGDIIKIDTRTCEYIQRV* lcl|CDS.1126|gb|C...</span></pre></div>

<p>We can use the <code>ranges()</code> method to extract <code>GRanges</code> objects defined in the
Bioconductor package <code>GenomicRanges</code>:</p>

<div class="highlight highlight-r"><pre><span class="pl-vo">elong_ranges</span> <span class="pl-k">&lt;-</span> ranges(<span class="pl-vo">elong</span>, <span class="pl-v">include</span> <span class="pl-k">=</span> c(<span class="pl-s1"><span class="pl-pds">"</span>locus_tag<span class="pl-pds">"</span></span>, <span class="pl-s1"><span class="pl-pds">"</span>protein_id<span class="pl-pds">"</span></span>, <span class="pl-s1"><span class="pl-pds">"</span>product<span class="pl-pds">"</span></span>))
<span class="pl-vo">elong_ranges</span>

 <span class="pl-c">##  GRanges with 7 ranges and 4 metadata columns:</span>
 <span class="pl-c">##               seqnames           ranges strand |         key   locus_tag</span>
 <span class="pl-c">##                  &lt;Rle&gt;        &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt; &lt;character&gt;</span>
 <span class="pl-c">##    CPS0B_0004 CP002806 [  3148,   5301]      + |         CDS  CPS0B_0004</span>
 <span class="pl-c">##    CPS0B_0056 CP002806 [ 56119,  56967]      - |         CDS  CPS0B_0056</span>
 <span class="pl-c">##    CPS0B_0219 CP002806 [206213, 208297]      + |         CDS  CPS0B_0219</span>
 <span class="pl-c">##    CPS0B_0509 CP002806 [526454, 527758]      - |         CDS  CPS0B_0509</span>
 <span class="pl-c">##    CPS0B_0600 CP002806 [623470, 624027]      + |         CDS  CPS0B_0600</span>
 <span class="pl-c">##    CPS0B_0751 CP002806 [805145, 806329]      - |         CDS  CPS0B_0751</span>
 <span class="pl-c">##    CPS0B_0928 CP002806 [997270, 997842]      - |         CDS  CPS0B_0928</span>
 <span class="pl-c">##                protein_id</span>
 <span class="pl-c">##               &lt;character&gt;</span>
 <span class="pl-c">##    CPS0B_0004  AEG87013.1</span>
 <span class="pl-c">##    CPS0B_0056  AEG87055.1</span>
 <span class="pl-c">##    CPS0B_0219  AEG87200.1</span>
 <span class="pl-c">##    CPS0B_0509  AEG87466.1</span>
 <span class="pl-c">##    CPS0B_0600  AEG87550.1</span>
 <span class="pl-c">##    CPS0B_0751  AEG87684.1</span>
 <span class="pl-c">##    CPS0B_0928  AEG87849.1</span>
 <span class="pl-c">##                                                           product</span>
 <span class="pl-c">##                                                       &lt;character&gt;</span>
 <span class="pl-c">##    CPS0B_0004 transcription elongation factor GreA domain protein</span>
 <span class="pl-c">##    CPS0B_0056                    translation elongation factor Ts</span>
 <span class="pl-c">##    CPS0B_0219                     translation elongation factor G</span>
 <span class="pl-c">##    CPS0B_0509                     transcription elongation factor</span>
 <span class="pl-c">##    CPS0B_0600                                 elongation factor P</span>
 <span class="pl-c">##    CPS0B_0751                    translation elongation factor Tu</span>
 <span class="pl-c">##    CPS0B_0928                     translation elongation factor P</span>
 <span class="pl-c">##    ---</span>
 <span class="pl-c">##    seqlengths:</span>
 <span class="pl-c">##     CP002806</span>
 <span class="pl-c">##      1172182</span></pre></div>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/gschofl">gschofl</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>