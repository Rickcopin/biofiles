{"name":"biofiles","tagline":"R interface to GenBank/GenPept files","body":"# biofiles - an interface to GenBank/GenPept files in R\r\n\r\n[![Build Status](https://travis-ci.org/gschofl/biofiles.png?branch=master)](https://travis-ci.org/gschofl/biofiles)\r\n\r\nThis is an R package for interfacing with GenBank and GenPept flat\r\nfile records. It includes utilities for reading and writing GenBank\r\nfiles, and methods for interacting with annotation and sequence data.\r\n\r\n### Installation\r\n\r\nThis package is ony available via github. It currently depends on the Boost\r\nregex library and will be made available on CRAN as soon as C++11 support is in\r\nplace on CRAN and I can get rid of this external dependency.\r\n\r\n\r\n\r\n```r\r\ninstall.packages(\"devtools\")  # if not already installed\r\nlibrary(\"devtools\")\r\ninstall_github(\"gschofl/biofiles\")\r\n```\r\n\r\n\r\n\r\n\r\n\r\n### Basic functionality\r\n\r\nLet's download a small bacterial genome, _Chlamydophila psittaci_ DC15\r\n(GenBank acc. CP002806; GI 334693792) from NCBI.\r\n\r\n\r\n\r\n```r\r\nrequire(reutils)\r\ngb_file <- efetch(\"CP002806\", \"nuccore\", rettype = \"gbwithparts\", retmode = \"text\")\r\n```\r\n\r\n\r\n\r\n\r\nNext, we parse the `efetch` object into a `gbRecord` instance.\r\n\r\n\r\n\r\n```r\r\nrec <- gbRecord(gb_file)\r\nrec\r\n\r\n ##  An object of class 'gbRecord', with 2040 features\r\n ##  LOCUS       CP002806             1172182 bp    DNA     circular BCT 31 ...\r\n ##  DEFINITION  Chlamydophila psittaci 02DC15, complete genome.\r\n ##  ACCESSION   CP002806\r\n ##  VERSION     CP002806.1  GI:334693792\r\n ##  DBLINK      Project: PRJNA66481\r\n ##  KEYWORDS    .\r\n ##  SOURCE      Chlamydia psittaci 02DC15\r\n ##    ORGANISM  Chlamydia psittaci 02DC15\r\n ##              Bacteria; Chlamydiae; Chlamydiales; Chlamydiaceae;\r\n ##              Chlamydia/Chlamydophila group; Chlamydia.\r\n ##  REFERENCE   1  (bases 1 to 1172182)\r\n ##    AUTHORS   Schofl,G., Voigt,A., Litsche,K., Sachse,K. and Saluz,H.P.\r\n ##    TITLE     Complete Genome Sequences of Four Mammalian Isolates of\r\n ##              Chlamydophila psittaci\r\n ##    JOURNAL   J. Bacteriol. 193 (16), 4258 (2011)\r\n ##    PUBMED    21705611\r\n ##  REFERENCE   2  (bases 1 to 1172182)\r\n ##    AUTHORS   Schofl,G.\r\n ##    TITLE     Direct Submission\r\n ##    JOURNAL   Submitted (20-MAY-2011) Cell and Molecular Biology,\r\n ##              Leibniz Institute for Natural Product Research and\r\n ##              Infection Biology, Beutenbergstrasse 11a, Jena D-07745,\r\n ##              Germany\r\n ##  COMMENT     Source DNA available from Dr. Konrad Sachse\r\n ##              (Konrad.Sachse@fli.bund.de) at the Institute for Molecular\r\n ##              Pathogenesis, Jena, Germany.\r\n ##  ORIGIN      CAAAGTTTTAAACATGTTAACCACGTTGTTTTCCCTCTATAAACCGAGTTTTAAACAGT\r\n ##              ...\r\n ##              ATCTTGTGTTCACAAACATGCAAAATCTCGATTTATTTACAAACTGAACAATGTTTTAA\r\n ##  CONTIG\r\n```\r\n\r\n\r\n\r\n\r\nThe `summary` function provides an overview over the object:\r\n\r\n\r\n\r\n```r\r\nsummary(rec)\r\n\r\n ##  [[CP002806]]\r\n ##    1172182 bp: Chlamydophila psittaci 02DC15, complete genome.\r\n ##     Id Feature Location                     GeneId Product           ...\r\n ##      1 source  1..1172182                   NA     NA                ...\r\n ##      2 gene    149..1144                    hemB   NA                ...\r\n ##      3 CDS     149..1144                    hemB   delta-aminolevuli ...\r\n ##      4 gene    complement(1160..2578)       NA     NA                ...\r\n ##      5 CDS     complement(1160..2578)       NA     Na(+)-translocati ...\r\n ##      6 gene    complement(2601..3035)       NA     NA                ...\r\n ##      7 CDS     complement(2601..3035)       NA     conserved hypothe ...\r\n ##    ... ...     ...                          ...    ...               ...\r\n ##   2034 CDS     1169125..1170006             NA     geranylgeranyl py ...\r\n ##   2035 gene    complement(1170021..1170094) NA     NA                ...\r\n ##   2036 tRNA    complement(1170021..1170094) NA     tRNA-Pro          ...\r\n ##   2037 gene    complement(1170106..1170360) NA     NA                ...\r\n ##   2038 CDS     complement(1170106..1170360) NA     conserved hypothe ...\r\n ##   2039 gene    complement(1170443..1172035) NA     NA                ...\r\n ##   2040 CDS     complement(1170443..1172035) NA     conserved hypothe ...\r\n```\r\n\r\n\r\n\r\n\r\nVarious getter methods provide access to the data contained in a GenBank record;\r\nfor instance:\r\n\r\n\r\n\r\n```r\r\ngetAccession(rec)\r\n\r\n ##  [1] \"CP002806\"\r\n```\r\n\r\n\r\n\r\n\r\n\r\n```r\r\ngetGeneID(rec)\r\n\r\n ##  [1] \"334693792\"\r\n```\r\n\r\n\r\n\r\n\r\n\r\n```r\r\ngetDefinition(rec)\r\n\r\n ##  [1] \"Chlamydophila psittaci 02DC15, complete genome.\"\r\n```\r\n\r\n\r\n\r\n\r\n\r\n```r\r\ngetOrganism(rec)\r\n\r\n ##  [1] \"Chlamydia psittaci 02DC15\"\r\n```\r\n\r\n\r\n\r\n\r\n\r\n```r\r\ngetSequence(rec)\r\n\r\n ##    A DNAStringSet instance of length 1\r\n ##        width seq                                        names               \r\n ##  [1] 1172182 CAAAGTTTTAAACATGTTAA...AAACTGAACAATGTTTTAA CP002806\r\n```\r\n\r\n\r\n\r\n\r\n\r\n```r\r\ngetReference(rec)\r\n\r\n ##  A 'gbReferenceList' instance:\r\n ##  REFERENCE   1  (bases 1 to 1172182)\r\n ##    AUTHORS   Schofl,G., Voigt,A., Litsche,K., Sachse,K. and Saluz,H.P.\r\n ##    TITLE     Complete Genome Sequences of Four Mammalian Isolates of\r\n ##              Chlamydophila psittaci\r\n ##    JOURNAL   J. Bacteriol. 193 (16), 4258 (2011)\r\n ##    PUBMED    21705611\r\n ##  REFERENCE   2  (bases 1 to 1172182)\r\n ##    AUTHORS   Schofl,G.\r\n ##    TITLE     Direct Submission\r\n ##    JOURNAL   Submitted (20-MAY-2011) Cell and Molecular Biology,\r\n ##              Leibniz Institute for Natural Product Research and\r\n ##              Infection Biology, Beutenbergstrasse 11a, Jena D-07745,\r\n ##              Germany\r\n ##  \r\n```\r\n\r\n\r\n\r\n\r\n`uniqueQualifs()` provides an overview over the feature qualifiers used\r\nin a record:\r\n\r\n\r\n\r\n```r\r\nuniqueQualifs(rec)\r\n\r\n ##   [1] \"organism\"            \"mol_type\"            \"strain\"             \r\n ##   [4] \"db_xref\"             \"gene\"                \"locus_tag\"          \r\n ##   [7] \"note\"                \"codon_start\"         \"transl_table\"       \r\n ##  [10] \"product\"             \"protein_id\"          \"translation\"        \r\n ##  [13] \"EC_number\"           \"artificial_location\"\r\n```\r\n\r\n\r\n\r\n\r\n### Genbank Features\r\n\r\nThe important part of GenBank record will generally be the list of annotions\r\nor features.\r\n\r\nWe can access the `gbFeatureList` of a `gbRecord` using `getFeatures()` or `ft()`:\r\n\r\n\r\n\r\n```r\r\nf <- ft(rec)\r\nf\r\n\r\n ##  'gbFeatureTable' with 2040 features:\r\n ##  Feature:        Location/Qualifiers:\r\n ##  source          1..1172182\r\n ##                  /organism = \"Chlamydia psittaci 02DC15\"\r\n ##                  /mol_type = \"genomic DNA\"\r\n ##                  /strain = \"02DC15\"\r\n ##                  /db_xref = \"taxon:1112254\"\r\n ##  ...\r\n ##  Feature:        Location/Qualifiers:\r\n ##  CDS             complement(1170443..1172035)\r\n ##                  /locus_tag = \"CPS0B_1080\"\r\n ##                  /note = \"[F] COG1351 Predicted alternative thymidylate\r\n ##                  synthase\"\r\n ##                  /codon_start = \"1\"\r\n ##                  /transl_table = \"11\"\r\n ##                  /product = \"conserved hypothetical protein\"\r\n ##                  /protein_id = \"AEG87987.1\"\r\n ##                  /db_xref = \"GI:334694770\"\r\n ##                  /translation = \"MLSRDDEFSSEQRKSLSHFVTNLETNIFALKNLPEVVKGA\r\n ##                  LFSKYSRSTLGLRSLLLKEFLEGEGGDFLDSSGVDFEVGIHKAADFYRRVLDGFG\r\n ##                  DDSIGELGGAHLAIESVSMLAAKILEDARIGGSPLEKSSRYVYFDQKVKGEYLYY\r\n ##                  RDPILMTSAFKDVFLGTCDFLFDTYADLIPKVRTYFEKIYPKESEVSQSAYTISL\r\n ##                  RAKVLDCLRGLLPAATLTNLGFFGNGRFWQTLLHKIQGHNLTEIRQIGESSLTEL\r\n ##                  MKIIPSFVSRAESHHHHHQAMLSYRQTLREQLTSLAEKFSGGSHPSKQTGVRLVY\r\n ##                  GDPEGIYKVAAGFLFPYSEHTYEELINICKSMPREDLIRVLEAGSSSRENRRHKS\r\n ##                  PRGLECLEFGFDITADFGAYRDLQRHRILTQERQLLTTNLGYHIPEQLLDTPMEK\r\n ##                  DFREAMEKAEEAYNQISLEFPEEAQYVVPLAYNIRWFFHINGRALQWLCELRSQV\r\n ##                  QGHENYRKIAIDMVKEVIRFDPVYESFFKFVDYSECDLGRIKQESRKRSF\"\r\n ##  Seqinfo:\r\n ##  CP002806  1172182 DNA  Chlamydophila psittaci 02DC15, complete genome.\r\n```\r\n\r\n\r\n\r\n\r\nWe can extract features either by numeric subsetting:\r\n\r\n\r\n```r\r\nf[[1]]\r\n\r\n ##  Feature:        Location/Qualifiers:\r\n ##  source          1..1172182\r\n ##                  /organism = \"Chlamydia psittaci 02DC15\"\r\n ##                  /mol_type = \"genomic DNA\"\r\n ##                  /strain = \"02DC15\"\r\n ##                  /db_xref = \"taxon:1112254\"\r\n ##  Seqinfo:\r\n ##  CP002806  1172182 DNA  Chlamydophila psittaci 02DC15, complete genome.\r\n```\r\n\r\n\r\n\r\n\r\nor we can subset by feature key:\r\n\r\n\r\n```r\r\nf[\"CDS\"][[2]]\r\n\r\n ##  Feature:        Location/Qualifiers:\r\n ##  CDS             complement(1160..2578)\r\n ##                  /locus_tag = \"CPS0B_0002\"\r\n ##                  /EC_number = \"1.6.5.-\"\r\n ##                  /note = \"[C] COG1726 Na+-transporting NADH:ubiquinone\r\n ##                  oxidoreductase, subunit NqrA\"\r\n ##                  /codon_start = \"1\"\r\n ##                  /transl_table = \"11\"\r\n ##                  /product = \"Na(+)-translocating NADH:ubiquinone\r\n ##                  oxidoreductase subunit A\"\r\n ##                  /protein_id = \"AEG87011.1\"\r\n ##                  /db_xref = \"GI:334693794\"\r\n ##                  /translation = \"MKIAITRGLDLSLQGSPKESGFLKRIDPALVSVDLRPYSA\r\n ##                  LTLKLKVEQGQAISSGSPVAEYKNFPGVFITSPVSGTVQEIRRGDKRSLLDVVIK\r\n ##                  KNPGQNLTEYSYDLSKLSRQELLEIFKKEGLFALFKQRPFDIPALPTHHPRDVFI\r\n ##                  NLADNRPFTPSTEKHLSVFSSREEGFYVFNVGVRAIAKLFGLCPHIISTDRLAIP\r\n ##                  EKDLKSIAHLHKITGPYPSGSPSTHIHYIAPITSEKDVVFTISFQEVLAIGHLFL\r\n ##                  KGRILNEQVVALAGSGLKPSLRRYVITTRGADFQSLLPLDEIASDQVSLISGDPL\r\n ##                  TGRLCDKEHLPCLGMRDATISVIPNPQKRQAFNFLRLGINKPTLTRTYLSGFLKR\r\n ##                  KHTYMDPDTNLHGETRPIIDTEIYDKVMAMKIPVVPLIKSVITKNFELACMLGFL\r\n ##                  EVCPEDFALPTFIDPSKTEMLTIIKEALKHYAKETGILNPENTADTE\"\r\n ##  Seqinfo:\r\n ##  CP002806  1172182 DNA  Chlamydophila psittaci 02DC15, complete genome.\r\n```\r\n\r\n\r\n\r\n\r\nA more versatile method to narrow down the list of features of interest is the \r\nfunction `filter()`.\r\nFor instance, we can filter for all coding sequences (CDS) with the\r\nannotation \"hypothetical\" in the product qualifiers:\r\n\r\n\r\n\r\n```r\r\nhypo <- filter(rec, key = \"CDS\", product = \"hypothetical\")\r\nsummary(hypo)\r\n\r\n ##  [[CP002806]]\r\n ##    1172182 bp: Chlamydophila psittaci 02DC15, complete genome.\r\n ##     Id Feature Location                     GeneId Product           ...\r\n ##      7 CDS     complement(2601..3035)       NA     conserved hypothe ...\r\n ##     31 CDS     20427..21713                 NA     conserved hypothe ...\r\n ##     33 CDS     21822..23741                 NA     conserved hypothe ...\r\n ##     35 CDS     complement(23931..26531)     NA     conserved hypothe ...\r\n ##     37 CDS     26689..29340                 NA     conserved hypothe ...\r\n ##     39 CDS     29390..29620                 NA     conserved hypothe ...\r\n ##     43 CDS     complement(30347..30832)     NA     conserved hypothe ...\r\n ##    ... ...     ...                          ...    ...               ...\r\n ##   2002 CDS     1152648..1153925             NA     conserved hypothe ...\r\n ##   2008 CDS     complement(1155986..1156711) NA     conserved hypothe ...\r\n ##   2010 CDS     complement(1156746..1157474) NA     conserved hypothe ...\r\n ##   2024 CDS     1163308..1164144             NA     conserved hypothe ...\r\n ##   2028 CDS     complement(1165683..1167527) NA     conserved hypothe ...\r\n ##   2038 CDS     complement(1170106..1170360) NA     conserved hypothe ...\r\n ##   2040 CDS     complement(1170443..1172035) NA     conserved hypothe ...\r\nr\r\nlength(hypo)\r\n\r\n ##  [1] 249\r\n```\r\n\r\n\r\n\r\n\r\nor we can filter for all elongation factors,\r\n\r\n\r\n\r\n```r\r\nelong <- filter(rec, key = \"CDS\", product = \"elongation factor\")\r\nsummary(elong)\r\n\r\n ##  [[CP002806]]\r\n ##    1172182 bp: Chlamydophila psittaci 02DC15, complete genome.\r\n ##     Id Feature Location                   GeneId Product             ...\r\n ##      9 CDS     3148..5301                 greA   transcription elong ...\r\n ##    103 CDS     complement(56119..56967)   tsf    translation elongat ...\r\n ##    408 CDS     206213..208297             fusA   translation elongat ...\r\n ##    950 CDS     complement(526454..527758) nusA   transcription elong ...\r\n ##   1126 CDS     623470..624027             NA     elongation factor P ...\r\n ##   1406 CDS     complement(805145..806329) tuf    translation elongat ...\r\n ##   1750 CDS     complement(997270..997842) efp    translation elongat ...\r\n```\r\n\r\n\r\n\r\n\r\nnow let's extract the sequence for all elongation factors, and using the tools\r\nfrom the `Biostrings` packages, translate them into protein sequences. Note, that\r\nin order to do so, we first get the `gbFeatureTable` from the `gbRecord`, as otherwise\r\nwe'd just extract the complete sequence associated with the GenBank record.\r\n\r\n\r\n\r\n```r\r\nrequire(Biostrings)\r\ndna <- getSequence(ft(elong))\r\ndna\r\n\r\n ##    A DNAStringSet instance of length 7\r\n ##      width seq                                          names               \r\n ##  [1]  2154 GTGGACTATCTAGAAAAGTTG...AATCTATTTGGGATGCATAA lcl|CDS.9|gb|CP00...\r\n ##  [2]   849 TTAAGCTCCTATTTTCCATAA...TCCATAGAAAAGTTGCTCAT lcl|CDS.103|gb|CP...\r\n ##  [3]  2085 ATGAGTGATCAAGAATTCGAT...AAGAGATTGTTAAGAAGTAA lcl|CDS.408|gb|CP...\r\n ##  [4]  1305 TTAATCTTCAATTTTAGGTTT...GCTACAAGATCTTTATTCAT lcl|CDS.950|gb|CP...\r\n ##  [5]   558 ATGGTATTAAGTAGCCAGCTC...AATATATTCAACGCGTCTAA lcl|CDS.1126|gb|C...\r\n ##  [6]  1185 TTAGGCAATAATTTTTGAAAT...TGAAAAGTTTCTTTTGACAT lcl|CDS.1406|gb|C...\r\n ##  [7]   573 TTACTTGGAAACACGCGATTC...CTAGTGCTTACACGAACCAT lcl|CDS.1750|gb|C...\r\n```\r\n\r\n\r\n\r\n\r\n\r\n\r\n```r\r\nstr <- strand(elong)\r\ndna_revcomp <- c(reverseComplement(dna[str == -1]), dna[str == 1])\r\naa <- translate(dna_revcomp)\r\nnames(aa) <- names(dna_revcomp)\r\naa\r\n\r\n ##    A AAStringSet instance of length 7\r\n ##      width seq                                          names               \r\n ##  [1]   283 MSNFSMETLKLLRQQTGVGLT...KTSGNSVEVKEFILWKIGA* lcl|CDS.103|gb|CP...\r\n ##  [2]   435 MNKDLVAIFDYMEKEKGIQRP...EQVSKYGEGKVDEKPKIED* lcl|CDS.950|gb|CP...\r\n ##  [3]   395 MSKETFQRTKPHINIGTIGHV...AIREGGRTIGAGTISKIIA* lcl|CDS.1406|gb|C...\r\n ##  [4]   191 MVRVSTSEFRVGLRIEIDGQP...GEVVKVDTRTGSYESRVSK* lcl|CDS.1750|gb|C...\r\n ##  [5]   718 VDYLEKLQVLIDEEQPSSFFN...LQFQGKKYKISRIQSIWDA* lcl|CDS.9|gb|CP00...\r\n ##  [6]   695 MSDQEFDLSKIRNIGIMAHID...EPAFFAKVPQKIQEEIVKK* lcl|CDS.408|gb|CP...\r\n ##  [7]   186 MVLSSQLSVGMFISTKDGLYK...EIGDIIKIDTRTCEYIQRV* lcl|CDS.1126|gb|C...\r\n```\r\n\r\n\r\n\r\n\r\nWe can use the `ranges()` method to extract `GRanges` objects defined in the\r\nBioconductor package `GenomicRanges`:\r\n\r\n\r\n\r\n```r\r\nelong_ranges <- ranges(elong, include = c(\"locus_tag\", \"protein_id\", \"product\"))\r\nelong_ranges\r\n\r\n ##  GRanges with 7 ranges and 4 metadata columns:\r\n ##               seqnames           ranges strand |         key   locus_tag\r\n ##                  <Rle>        <IRanges>  <Rle> | <character> <character>\r\n ##    CPS0B_0004 CP002806 [  3148,   5301]      + |         CDS  CPS0B_0004\r\n ##    CPS0B_0056 CP002806 [ 56119,  56967]      - |         CDS  CPS0B_0056\r\n ##    CPS0B_0219 CP002806 [206213, 208297]      + |         CDS  CPS0B_0219\r\n ##    CPS0B_0509 CP002806 [526454, 527758]      - |         CDS  CPS0B_0509\r\n ##    CPS0B_0600 CP002806 [623470, 624027]      + |         CDS  CPS0B_0600\r\n ##    CPS0B_0751 CP002806 [805145, 806329]      - |         CDS  CPS0B_0751\r\n ##    CPS0B_0928 CP002806 [997270, 997842]      - |         CDS  CPS0B_0928\r\n ##                protein_id\r\n ##               <character>\r\n ##    CPS0B_0004  AEG87013.1\r\n ##    CPS0B_0056  AEG87055.1\r\n ##    CPS0B_0219  AEG87200.1\r\n ##    CPS0B_0509  AEG87466.1\r\n ##    CPS0B_0600  AEG87550.1\r\n ##    CPS0B_0751  AEG87684.1\r\n ##    CPS0B_0928  AEG87849.1\r\n ##                                                           product\r\n ##                                                       <character>\r\n ##    CPS0B_0004 transcription elongation factor GreA domain protein\r\n ##    CPS0B_0056                    translation elongation factor Ts\r\n ##    CPS0B_0219                     translation elongation factor G\r\n ##    CPS0B_0509                     transcription elongation factor\r\n ##    CPS0B_0600                                 elongation factor P\r\n ##    CPS0B_0751                    translation elongation factor Tu\r\n ##    CPS0B_0928                     translation elongation factor P\r\n ##    ---\r\n ##    seqlengths:\r\n ##     CP002806\r\n ##      1172182\r\n```\r\n\r\n\r\n\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}